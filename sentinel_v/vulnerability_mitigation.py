from art.estimators.classification import SklearnClassifier
from art.attacks.evasion import FastGradientMethod
from art.defences.trainer import AdversarialTrainer
from sklearn.svm import SVC
import numpy as np

class RobustModel:
    def __init__(self):
        self.classifier = SklearnClassifier(model=SVC())
    
    def train_robust(self, x_train, y_train):
        trainer = AdversarialTrainer(self.classifier, attacks=FastGradientMethod(self.classifier, eps=0.3))
        trainer.fit(x_train, y_train)
    
    def predict(self, x):
        return self.classifier.predict(x)

# Example
if __name__ == "__main__":
    x_train = np.random.rand(100, 10)
    y_train = np.random.randint(0, 2, 100)
    model = RobustModel()
    model.train_robust(x_train, y_train)
    print(model.predict(np.random.rand(1, 10)))
